<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" name="viewport" />
  <title>
    
    [Design] Multithreading Basics 丨
    

    typo
  </title>

  
  <link rel="shortcut icon" href="/icon.svg">
  

  <link rel="preconnect" href="https://cdnjs.cloudflare.com">
  
  <link id="theme" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-light.css">
  <script src="https://unpkg.com/@highlightjs/cdn-assets@11.9.0/highlight.min.js"></script>
  

  <!-- 字体 -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:ital,wght@0,100..800;1,100..800&display=swap" rel="stylesheet">

  
<link rel="stylesheet" href="/css/root.css">

  
<link rel="stylesheet" href="/css/style.css">

  
<link rel="stylesheet" href="/css/post.css">

<meta name="generator" content="Hexo 7.3.0"></head>

<body>
  <header class="header">
  <section class="header-container">
    <a class="logo" href="/">Tech blog</a>
    <ul class="nav">
      
      <li><a href="/archives">archives</a></li>
      
      <li><a href="/about">about</a></li>
      
    </ul>
  </section>
</header>
  <main class="main">
    <article class="post">
  
  <div class="post-title">[Design] Multithreading Basics</div>
  <div class="post-meta">
    <div class="date">2014 July 24th</div>
    <div class="tags">
      
    </div>
  </div>
  

  <main class="post-content"><h2 id="Terminologies"><a href="#Terminologies" class="headerlink" title="Terminologies"></a>Terminologies</h2><h3 id="Atomicity-Atomic-Operation"><a href="#Atomicity-Atomic-Operation" class="headerlink" title="Atomicity, Atomic Operation"></a>Atomicity, Atomic Operation</h3><p><strong><a target="_blank" rel="noopener" href="http://www.geeksforgeeks.org/g-fact-57/">Atomicity</a> is unbreakability</strong>, or uninterrupted operation.</p>
<p>Atomic operation helps in understanding reentrancy, critical section, thread safety, synchronization primitives, etc.</p>
<h3 id="Critical-Section"><a href="#Critical-Section" class="headerlink" title="Critical Section"></a>Critical Section</h3><p><strong><a target="_blank" rel="noopener" href="http://www.geeksforgeeks.org/g-fact-70/">Critical section</a></strong> is group of instructions&#x2F;statements or region of code that <strong>need to be executed atomically</strong>.</p>
<p>If one thread tries to change a shared data while another thread tries to read, the result is unpredictable. It is critical to understand the importance of race condition while writing kernel mode programming.</p>
<p>A simple solution to critical section:</p>
<pre><code>acquireLock();
Process Critical Section
releaseLock();
</code></pre>
<h3 id="Synchronization-primitives"><a href="#Synchronization-primitives" class="headerlink" title="Synchronization primitives"></a>Synchronization primitives</h3><p><a target="_blank" rel="noopener" href="http://stackoverflow.com/a/8017629">Synchronization primitives</a> are simple software mechanisms for the purposes of supporting thread or process synchronization.</p>
<p><strong>Mutex, event, conditional variables and semaphores</strong> are all synchronization primitives.</p>
<p><strong>Critical section</strong> is not a synchronization primitive. It’s a part of an execution path that must be protected from concurrent execution in order to maintain some invariants.</p>
<p>You need to use some synchronization primitives to protect critical section.</p>
<h3 id="Producer–consumer"><a href="#Producer–consumer" class="headerlink" title="Producer–consumer"></a>Producer–consumer</h3><p>Two processes, <a target="_blank" rel="noopener" href="http://en.wikipedia.org/wiki/Producer-consumer_problem">producer and consumer</a>. Producer thread will collect the data and writes it to the buffer. Consumer thread will process the collected data from the buffer.</p>
<p>Producer won’t try to add when buffer’s full and consumer won’t remove when buffer’s empty.</p>
<p><strong>Solution 1: Mutex</strong></p>
<p>A mutex provides mutual exclusion, either producer or consumer can have the key (mutex) and proceed with their work. As long as the buffer is filled by producer, the consumer needs to wait, and vice versa.</p>
<p><strong>Solution 2: Semaphore</strong></p>
<p><a target="_blank" rel="noopener" href="http://en.wikipedia.org/wiki/Producer-consumer_problem#Using_semaphores">A semaphore</a> is a generalized mutex. In lieu of single buffer, we can split the 4 KB buffer into four 1 KB buffers (identical resources). A semaphore can be associated with these four buffers. The consumer and producer can work on different buffers at the same time.</p>
<h3 id="Interrupt-service-routine"><a href="#Interrupt-service-routine" class="headerlink" title="Interrupt service routine"></a>Interrupt service routine</h3><p><a target="_blank" rel="noopener" href="http://en.wikipedia.org/wiki/Interrupt_handler">Interrupt service routine</a> (ISR), is a callback subroutine in an operating system or device driver whose execution is triggered by the reception of an interrupt.</p>
<p><a target="_blank" rel="noopener" href="http://stackoverflow.com/a/3392889">One good example</a> is reading from a hard drive. The drive is slow and you don’t want your OS to wait for the data to come back; you want the OS to go and do other things. <strong>So you set up the system so that when the disk has the data (ready), it raises an interrupt</strong>. In the <strong>ISR for the disk</strong>, CPU will take the data and return it to the requester.</p>
<p><strong>ISRs often need to happen quickly</strong> as the hardware can have a limited buffer, which will be overwritten by new data if it’s now pulled off quickly enough.</p>
<p>It’s also important to have your ISR complete quickly as while the CPU is servicing one ISR other interrupts will be masked.</p>
</main>

</article>


<script src="/js/highlight.js"></script>

  </main>
  <footer class="footer">
  
  <span>Copyright © 2024 typo</span>
  
</footer>
  
<script src="/js/theme.js"></script>

</body>

</html>