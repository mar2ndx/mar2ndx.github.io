<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" name="viewport" />
  <title>
    
    [Design] Big Data - Top k Frequency (hands-on)  丨
    

    typo
  </title>

  
  <link rel="shortcut icon" href="/icon.svg">
  

  <link rel="preconnect" href="https://cdnjs.cloudflare.com">
  
  <link id="theme" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-light.css">
  <script src="https://unpkg.com/@highlightjs/cdn-assets@11.9.0/highlight.min.js"></script>
  

  <!-- 字体 -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:ital,wght@0,100..800;1,100..800&display=swap" rel="stylesheet">

  
<link rel="stylesheet" href="/css/root.css">

  
<link rel="stylesheet" href="/css/style.css">

  
<link rel="stylesheet" href="/css/post.css">

<meta name="generator" content="Hexo 7.3.0"></head>

<body>
  <header class="header">
  <section class="header-container">
    <a class="logo" href="/">Tech blog</a>
    <ul class="nav">
      
      <li><a href="/archives">archives</a></li>
      
      <li><a href="/about">about</a></li>
      
    </ul>
  </section>
</header>
  <main class="main">
    <article class="post">
  
  <div class="post-title">[Design] Big Data - Top k Frequency (hands-on) </div>
  <div class="post-meta">
    <div class="date">2015 January 9th</div>
    <div class="tags">
      
    </div>
  </div>
  

  <main class="post-content"><h3 id="Question"><a href="#Question" class="headerlink" title="Question"></a>Question</h3><p><a target="_blank" rel="noopener" href="http://stackoverflow.com/a/3262855">link</a></p>
<blockquote>
<p>The input is an endless stream of English words or phrases (we refer them as tokens).</p>
</blockquote>
<blockquote>
<p>Output top N tokens we have seen so far (from all the tokens we have seen!)</p>
</blockquote>
<h3 id="Analysis"><a href="#Analysis" class="headerlink" title="Analysis"></a>Analysis</h3><p>We will discuss the following details of implementation and optimization.</p>
<ol>
<li>String into Integer</li>
<li>Data Storage</li>
<li>Process Incoming Streams</li>
<li>Save result</li>
</ol>
<h4 id="1-String-into-Integer"><a href="#1-String-into-Integer" class="headerlink" title="1. String into Integer"></a>1. String into Integer</h4><p>This is a nice trick that improves eficiency a lot.</p>
<blockquote>
<p>Though there is almost infinite possible words on the Internet, but after accumulating a large set of words, the possibility of finding new words becomes lower and lower.</p>
</blockquote>
<blockquote>
<p>We have already found 4 million different words, and assigned a unique ID for each. This is important, because sorting and comparisons on integers is <strong>much much faster</strong> than on strings.</p>
</blockquote>
<h4 id="2-Data-Storage"><a href="#2-Data-Storage" class="headerlink" title="2. Data Storage"></a>2. Data Storage</h4><blockquote>
<p>The system keeps archive data for every token. Basically it’s pairs of (Token, Frequency).</p>
</blockquote>
<blockquote>
<p>However, the table that stores the data would be so huge such that we have to partition the table physically. One partition scheme is <strong>based on ngrams</strong> of the token. If the token is a single word, it is 1gram. If the token is two-word phrase, it is 2gram.</p>
</blockquote>
<p>Of course we can also divide the data by the hash value. For information on <strong>ngrams</strong>, read <strong>[Design] Terminology: n-gram</strong>.</p>
<h4 id="3-Process-Incoming-Streams"><a href="#3-Process-Incoming-Streams" class="headerlink" title="3. Process Incoming Streams"></a>3. Process Incoming Streams</h4><blockquote>
<p>The system will absorbs incoming sentences until memory becomes fully utilized (Ya, we need a MemoryManager). After taking N sentences and storing in memory, the system pauses, and starts tokenize each sentence into words and phrases. Each token (word or phrase) is counted.</p>
</blockquote>
<p>This data processing logic runs as a process under Memory-Manager. The next part is another processing running concurrently.</p>
<h4 id="4-Save-result"><a href="#4-Save-result" class="headerlink" title="4. Save result"></a>4. Save result</h4><blockquote>
<p>Meanwhile, there will be another process that is activated once it finds any disk file generated by the system, then start merging it. Since the disk file is sorted, merging would take <strong>a similar process like merge sort</strong>.</p>
</blockquote>
<p>There is <a target="_blank" rel="noopener" href="http://stackoverflow.com/a/3262855">some more steps</a> afterwards, but they’re trivial. I have listed out the basic steps for processing large stream of incoming data (as string), and how to find out the Top K keywords.</p>
<p>I suggest you read previous <strong>[Design] Big Data - Top k Frequency</strong> posts before reading this.</p>
</main>

</article>


<script src="/js/highlight.js"></script>

  </main>
  <footer class="footer">
  
  <span>Copyright © 2024 typo</span>
  
</footer>
  
<script src="/js/theme.js"></script>

</body>

</html>