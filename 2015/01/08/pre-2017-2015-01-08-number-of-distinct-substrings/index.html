<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" name="viewport" />
  <title>
    
    [Google] Number of distinct substrings  丨
    

    typo
  </title>

  
  <link rel="shortcut icon" href="/icon.svg">
  

  <link rel="preconnect" href="https://cdnjs.cloudflare.com">
  
  <link id="theme" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-light.css">
  <script src="https://unpkg.com/@highlightjs/cdn-assets@11.9.0/highlight.min.js"></script>
  

  <!-- 字体 -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:ital,wght@0,100..800;1,100..800&display=swap" rel="stylesheet">

  
<link rel="stylesheet" href="/css/root.css">

  
<link rel="stylesheet" href="/css/style.css">

  
<link rel="stylesheet" href="/css/post.css">

<meta name="generator" content="Hexo 7.3.0"></head>

<body>
  <header class="header">
  <section class="header-container">
    <a class="logo" href="/">Tech blog</a>
    <ul class="nav">
      
      <li><a href="/archives">archives</a></li>
      
      <li><a href="/about">about</a></li>
      
    </ul>
  </section>
</header>
  <main class="main">
    <article class="post">
  
  <div class="post-title">[Google] Number of distinct substrings </div>
  <div class="post-meta">
    <div class="date">2015 January 8th</div>
    <div class="tags">
      
    </div>
  </div>
  

  <main class="post-content"><h3 id="Question"><a href="#Question" class="headerlink" title="Question"></a>Question</h3><p><a target="_blank" rel="noopener" href="http://www.quora.com/Given-a-string-how-do-I-find-the-number-of-distinct-substrings-of-the-string">link</a></p>
<blockquote>
<p>Given a string, find the number of distinct substrings of the string. Example:</p>
</blockquote>
<blockquote>
<p>input &#x3D; “aaaa”,</p>
<p>output &#x3D; 4 (the 4 substrings are “a”, “aa”, “aaa”, “aaaa”)</p>
</blockquote>
<blockquote>
<p>input &#x3D; “abcd”,</p>
<p>output &#x3D; 10 (“a”, “b”, “c”, “d”, “ab”, “bc”, “cd”, “abc”, “bcd”, “abcd”)</p>
</blockquote>
<blockquote>
<p>input &#x3D; “banana”,</p>
<p>output &#x3D; 15 (“a”, “an”, “ana”, “anan”, “anana”, “b”, “ba”, “ban”, “bana”, “banan”, “banana”, “n”, “na”, “nan”, “nana”)</p>
</blockquote>
<p>This is also a question on <a target="_blank" rel="noopener" href="http://www.spoj.com/problems/DISUBSTR/">SPOJ</a>.</p>
<h3 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h3><p>This is a very good question, which tests Suffix tree, LCP and string manipulation knowledges.</p>
<p><strong>The solution is to build a suffix tree</strong>. This is because:</p>
<blockquote>
<p>If you look through the <strong><a target="_blank" rel="noopener" href="http://qr.ae/6o6Nk">prefixes of each suffix</a></strong> of a string, you have covered all substrings of that string.</p>
</blockquote>
<p>There are 2 implementations. First one is slightly simpler.</p>
<h4 id="Implementation-1"><a href="#Implementation-1" class="headerlink" title="Implementation 1"></a>Implementation 1</h4><p><strong>Suffix array + LCP</strong> (longest common prefix). Take “Banana” as input, then the suffixes:</p>
<pre><code>0) BANANA
1) ANANA
2) NANA
3) ANA
4) NA
5) A
</code></pre>
<p>Sort it:</p>
<pre><code>5) A
3) ANA
1) ANANA
0) BANANA
4) NA
2) NANA
</code></pre>
<p>Then we start calculate number of substring (that is prefixes of suffix). After removing duplicated prefix, the count is:</p>
<pre><code>5) A - 1
3) ANA - 2
1) ANANA - 2
0) BANANA - 6
4) NA - 2
2) NANA - 2
</code></pre>
<p>Total number is:</p>
<pre><code>1 + 2 + 2 + 6 + 2 + 2 = 15
</code></pre>
<p>But wait, realize something? “A” is simply duplicate substring in “ANA”, which appers in “ANANA”. Keep this in mind, cuz we need to observe this in the 2nd implementation, too.</p>
<p>Finally, the total number is calculated like this:</p>
<pre><code>for each suffix
    ans += length(suffix) - LCP(suffix, previous suffix)
</code></pre>
<p>For more details, read <a target="_blank" rel="noopener" href="http://qr.ae/6o6Nk">here</a>.</p>
<h4 id="Implementation-2"><a href="#Implementation-2" class="headerlink" title="Implementation 2"></a>Implementation 2</h4><p>Build a suffix tree, like this:</p>
<p><img src="/images/suffix-tree-banana.png"></p>
<p>Number of substrings is simply the <strong>sum of levels of each leaf</strong>. For the 3 branches of the suffix tree, number of levels are: 6, 5 and 4 respectively. Total &#x3D; 15.</p>
</main>

</article>


<script src="/js/highlight.js"></script>

  </main>
  <footer class="footer">
  
  <span>Copyright © 2024 typo</span>
  
</footer>
  
<script src="/js/theme.js"></script>

</body>

</html>